{"version":3,"sources":["pages/formManagement/index.module.less","pages/formManagement/uploadTemplate.js","pages/common/PreviewDoc.js","pages/formManagement/util.js"],"names":["module","exports","container","splitLine","folderContainer","buttonContainer","folderTree","formContainer","filterBox","filterItem","table","workFlowContainer","left","right","workPlace","buttons","item","body","Dragger","UploadTemplate","state","param","data","isNeedUpload","fileName","formId","showPDF","getData","_this","getAction","id","then","res","success","obj","formTemplatePath","setState","formTemplateName","getWidgetList","handleFinish","antd_es_message__WEBPACK_IMPORTED_MODULE_11__","warning","props","history","push","error","goto","replace","concat","_previewDoc","_this2","this","parseUrlSearch","_this3","that","ticket","localStorage","getItem","addurl","name","accept","multiple","action","showUploadList","onChange","info","status","file","console","log","response","msg","react__WEBPACK_IMPORTED_MODULE_19___default","a","createElement","style","padding","antd_es_card__WEBPACK_IMPORTED_MODULE_5__","title","window","sessionStorage","className","styles","bodyStyle","extra","length","map","marginBottom","display","width","textAlign","columnComment","columnName","antd_es_empty__WEBPACK_IMPORTED_MODULE_9__","antd_es_icon__WEBPACK_IMPORTED_MODULE_7__","type","marginTop","marginRight","onClick","color","cursor","antd_es_button__WEBPACK_IMPORTED_MODULE_3__","ghost","margin","antd_es_modal__WEBPACK_IMPORTED_MODULE_1__","visible","fontWeight","height","destroyOnClose","footer","onCancel","_pages_common_PreviewDoc__WEBPACK_IMPORTED_MODULE_23__","Component","withRouter","hasDocsAPI","PreviewDoc","Object","_Users_bobo_Documents_sunmnet_font_project_YBT_PRODUCT_FRONT_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__","_Users_bobo_Documents_sunmnet_font_project_YBT_PRODUCT_FRONT_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_5__","_Users_bobo_Documents_sunmnet_font_project_YBT_PRODUCT_FRONT_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_6__","call","_getFormTaskInfo","orginUrl","location","host","_Users_bobo_Documents_sunmnet_font_project_YBT_PRODUCT_FRONT_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread2__WEBPACK_IMPORTED_MODULE_2__","url","sessionId","_setConfig","antd_es_message__WEBPACK_IMPORTED_MODULE_1__","historyId","planTaskIds","join","document","getElementById","src","documentServerApiUrl","script","async","head","appendChild","config","_openEditor","DocsAPI","Promise","reject","canDownload","docEditor","DocEditor","documentType","fileType","key","permissions","download","print","edit","fillForms","comment","editorConfig","mode","lang","customization","chat","comments","help","autosave","commentAuthorOnly","compactToolbar","logo","image","imageEmbedded","about","plugins","autostart","pluginsData","catch","warn","setTimeout","react__WEBPACK_IMPORTED_MODULE_8___default","React","defaultProps","PropType","PropTypes","string","isRequired","__webpack_require__","d","__webpack_exports__","href","paramsIndex","searchObj","indexOf","params","substr","split","forEach","arr"],"mappings":"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","file":"static/js/48.950197fe.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"src-pages-formManagement-index-module__container--3tW0P\",\"splitLine\":\"src-pages-formManagement-index-module__splitLine--3YJ5k\",\"folderContainer\":\"src-pages-formManagement-index-module__folderContainer--QTnq-\",\"buttonContainer\":\"src-pages-formManagement-index-module__buttonContainer--1Izqz\",\"folderTree\":\"src-pages-formManagement-index-module__folderTree--1d1J_\",\"formContainer\":\"src-pages-formManagement-index-module__formContainer--2E41i\",\"filterBox\":\"src-pages-formManagement-index-module__filterBox--3Ll83\",\"filterItem\":\"src-pages-formManagement-index-module__filterItem--2HREF\",\"table\":\"src-pages-formManagement-index-module__table--1WDgV\",\"workFlowContainer\":\"src-pages-formManagement-index-module__workFlowContainer--2DUB1\",\"left\":\"src-pages-formManagement-index-module__left--17pGX\",\"right\":\"src-pages-formManagement-index-module__right--1HjLB\",\"workPlace\":\"src-pages-formManagement-index-module__workPlace--2jRRC\",\"buttons\":\"src-pages-formManagement-index-module__buttons--2GZ0j\",\"item\":\"src-pages-formManagement-index-module__item--qYz39\",\"body\":\"src-pages-formManagement-index-module__body--1HHqD\"};","import React, { Component } from 'react'\nimport { Card, Button, message, Upload, Icon,Empty,Modal } from 'antd'\nimport styles from './index.module.less'\nimport { parseUrlSearch } from './util'\nimport { withRouter } from 'react-router-dom';\nimport PreviewDoc from '@/pages/common/PreviewDoc';\nimport {getAction} from '@/axios';\nconst { Dragger } = Upload;\nclass UploadTemplate extends Component {\n    state = {\n        param: {},\n        data:[],\n        isNeedUpload:true,\n        fileName:'',\n        formId:null,//当前预览的记录信息\n        showPDF:false,\n    }\n    componentDidMount() {\n        let param = parseUrlSearch()\n        if (param.id) {\n            this.setState({\n                param\n            }, () => {\n                this.getData()\n                this.getWidgetList()\n            })\n        }\n    }\n    getData = () => {\n        let { param } = this.state\n        getAction('/ybt/form/info',{\n            formId:param.id\n        }).then(res=>{\n            if (res.success) {\n              if(res.obj.formTemplatePath){\n                //   已有模板不用上传\n                this.setState({\n                    isNeedUpload:false,\n                    fileName:res.obj.formTemplateName,\n                })\n              }else{\n                this.setState({\n                    isNeedUpload:true,\n                    fileName:res.obj.formTemplateName\n                })\n              }\n            }\n        });\n        \n    }\n    getWidgetList=()=>{\n        let { param } = this.state\n        getAction('/ybt/form/widget/list',{\n            formId:param.id\n        }).then(res=>{\n            if (res.success) {\n                this.setState({\n                    data: res.obj\n                })\n            }\n        });\n    }\n    handleFinish = () => {\n        let { param } = this.state\n        if(this.state.isNeedUpload){\n            message.warning('请先上传模板文件')\n            return\n        }\n        getAction('/ybt/form/create/submit',{\n            formId:param.id\n        }).then(res=>{\n            if (res.success) {\n                message.success('操作成功')\n                this.props.history.push('/formManagement')\n            }else{\n                message.error(res.obj)\n            }\n        });\n    }\n    goto=()=>{\n        this.props.history.replace(`/formManagement/setWorkFlow?id=${this.state.param.id}`)\n    }\n    //预览\n    _previewDoc = () => {\n        this.setState({\n            showPDF:true\n        });\n    }\n    render() {\n        let that=this,id=that.state.param?that.state.param.id:'';\n        let ticket = localStorage.getItem(\"ticket\");\n        let addurl = \"\";\n        if(ticket){\n            addurl = \"?ticket=\"+ticket;\n        }\n        const props = {\n            name: 'file',\n            accept:'.xml',\n            multiple: false,\n            action: `/ybt/form/uploadTemplate/${id}${addurl}`,\n            showUploadList:false,\n            onChange(info) {\n                const { status } = info.file;\n                if (status !== 'uploading') {\n                    // console.log(info.file, info.fileList);\n                }\n                if (status === 'done') {\n                    console.log(info.file.response)\n                    if(info.file.response&&info.file.response.success){\n                        // console.log(info.file.response)\n                        message.success(`${info.file.name} 上传成功`);\n                        that.setState({\n                            isNeedUpload:false,\n                            fileName:info.file.name,\n                            formId:info.file.response.obj.formId\n                        })\n                    }else{\n                        message.error(info.file.response.msg)\n                    }\n                } else if (status === 'error') {\n                    message.error(`${info.file.name} 上传失败`);\n                }\n            },\n        };\n        return (\n            <div style={{ padding: 20 }}>\n                <Card title={`上传模板-${window.sessionStorage.getItem('formManageName')}`} className={styles.body} bodyStyle={{padding:0}} extra={<div>【请上传XML格式模板文件】</div>}>\n                    <div className={styles.item} style={{padding:'20px 0'}}>\n                        {\n                            this.state.data.length>0?(\n                                <div>\n                                    {\n                                        this.state.data.map(item=>{\n                                            return (\n                                                <div style={{marginBottom:20}}>\n                                                    <span\n                                                        style={{\n                                                            display:'inline-block',\n                                                            width:150,\n                                                            textAlign:'right'\n                                                        }}\n                                                    >{item.columnComment}：</span>\n                                                    <span>{item.columnName}</span>\n                                                </div>\n                                            )\n                                        })\n                                    }\n                                </div>\n                            ):<Empty/>\n                        }\n                        \n                    </div>\n                    <div className={styles.item} style={{padding:50}}>\n                        <Dragger {...props}>\n                            <p className=\"ant-upload-drag-icon\">\n                                <Icon type=\"inbox\" />\n                            </p>\n                            <p className=\"ant-upload-text\">点击或将文件拖拽到这里上传</p>\n                            {/* <p className=\"ant-upload-hint\">\n                                仅支持doc/docx文件\n                            </p> */}\n                        </Dragger>\n                        {\n                            this.state.isNeedUpload?null:<div style={{marginTop:10}}><Icon type=\"link\" style={{marginRight:10}} />{this.state.fileName}<span onClick={this._previewDoc} style={{color:'blue',cursor:'pointer'}}>[预览]</span></div>\n                        }\n                    </div>\n                </Card>\n                <div className={styles.buttons} style={{ textAlign: 'right', marginTop: 10 }}>\n                    <Button type=\"primary\" ghost onClick={this.goto} >上一步</Button>\n                    <Button type=\"primary\" style={{ margin: \"0px 10px\" }} onClick={this.handleFinish}>完成</Button>\n                    <Button onClick={() => { this.props.history.push('/formManagement') }}>取消</Button>\n                </div>\n                <Modal\n                    visible={this.state.showPDF}\n                    title={<span style={{fontWeight:\"bold\"}}>预览打印</span>}\n                    width={1200}\n                    bodyStyle={{padding:0,height:\"70vh\"}}\n                    destroyOnClose={true}\n                    footer={false}\n                    onCancel={()=>{this.setState({showPDF:false})}}\n                >\n                    <PreviewDoc id={this.state.param.id} type='formId'/>\n                </Modal>\n            </div>\n        )\n    }\n}\n\n\nexport default withRouter(UploadTemplate)","import React from 'react';\nimport PropTypes from 'prop-types';\nimport {getAction} from '@/axios';\nimport { message } from 'antd';\n\nlet hasDocsAPI = false;\nclass PreviewDoc extends React.Component{\n    constructor(props){\n        super(props);\n        this.state = {\n            config:{\n                documentServerApiUrl:'',documentType:'',fileType:'',key:'',title:'',url:''\n            }\n        }\n    }\n    componentDidMount(){\n        this._getFormTaskInfo();\n    }\n    _getFormTaskInfo = () => {\n        // let orginUrl = '10.175.205.18:8183';//测试时localhost得改成代理地址\n        let orginUrl = window.location.host;\n        if(this.props.type==='formTaskId'){//表单任务预览\n            getAction(`/ybt/form/preview/formTask/info?formTaskId=${this.props.id}`).then(res=>{\n                if(res.success){\n                    let info = {...res.obj,url:`http://${orginUrl}/ybt/form/preview/formTask;JSESSIONID=${res.obj.sessionId}?formTaskId=${this.props.id}`};\n                    this._setConfig(info)\n                }else{\n                    message.error(res.obj)\n                }\n            })\n        }else if(this.props.type==='formId'){//表单预览\n            getAction(`/ybt/form/preview/form/info?formId=${this.props.id}`).then(res=>{\n                if(res.success){\n                    let info = {...res.obj,url:`http://${orginUrl}/ybt/form/preview/form;JSESSIONID=${res.obj.sessionId}?formId=${this.props.id}`};\n                    this._setConfig(info)\n                }else{\n                    message.error(res.obj)\n                }\n            })\n        }else if(this.props.type==='summary'){\n            getAction(`/ybt/summary/preview/info?templetId=${this.props.id}`).then(res=>{\n                if(res.success){\n                    let info = {...res.obj,url:`http://${orginUrl}/ybt/summary/data/preview;JSESSIONID=${res.obj.sessionId}?templetId=${this.props.id}&historyId=${this.props.historyId}`};\n                    this._setConfig(info)\n                }else{\n                    message.error(res.obj)\n                }\n            })\n        }else if(this.props.type==='summaryPreview'){\n            getAction(`/ybt/summary/preview/info?templetId=${this.props.id}`).then(res=>{\n                if(res.success){\n                    let info = {...res.obj,url:`http://${orginUrl}/ybt/summary/data/pre/preview/ids;JSESSIONID=${res.obj.sessionId}?templetId=${this.props.id}&planTaskIds=${this.props.planTaskIds.join(',')}`};\n                    this._setConfig(info)\n                }else{\n                    message.error(res.obj)\n                }\n            })\n        }\n    }\n    _setConfig = (info) => {\n        let documentScript = document.getElementById('documentScript');\n        if(documentScript){\n            let script = document.getElementById('documentScript');\n            script.src = info.documentServerApiUrl;\n        }else{\n            let script = document.createElement('script');\n            script.id = 'documentScript'\n            script.type = 'text/javascript';\n            script.async = false;\n            script.src = info.documentServerApiUrl;\n            document.head.appendChild(script);\n        }\n        this.setState({config:info},this._openEditor)\n    }\n    _openEditor = () => {\n        let info = this.state.config;\n        let DocsAPI = window.DocsAPI;\n        if(DocsAPI){\n            hasDocsAPI = true;\n        }\n        if(hasDocsAPI){\n            let canDownload =  getAction('/ybt/form/task/getFormTaskStatus?formTaskId='+this.props.id).then(res=>{\n                if(res.success){\n                     if(res.obj===1){\n                        return true\n                     }else{\n                         return false;\n                     }\n                }else{\n                    return Promise.reject(res.obj)\n                }\n            })\n            canDownload.then(canDownload=>{\n                hasDocsAPI = true;\n                let ticket = localStorage.getItem(\"ticket\");\n                if (ticket) {\n                    info.url = info.url + \"&ticket=\" + ticket\n                }\n                window.docEditor = new DocsAPI.DocEditor(\"PreviewDoc\",\n                {\n                    documentType: info.documentType,\n                    document: {\n                        fileType: info.fileType,\n                        key: info.key,\n                        title: info.title,\n                        url: info.url,\n                        permissions:{\n                            download:this.props.type===\"formId\"?true:canDownload,//下载权限\n                            print:this.props.type===\"formId\"?true:canDownload,//打印\n                            edit: false,\n                            fillForms: false,\n                            comment:false,\n                        },\n                    },\n                    editorConfig: {\n                        mode: \"view\",\n                        lang: \"zh\",\n                        customization:{\n                            chat:false,//聊天\n                            comments:false,//评论\n                            help:false,//帮助菜单\n                            \"autosave\": true,\n                            \"commentAuthorOnly\": false,\n                            \"compactToolbar\": false,\n                            logo:{\n                                image:null,\n                                url:null,\n                                imageEmbedded:null\n                            },\n                            about:false,\n                        },\n                        plugins:{\n                            autostart:[],\n                            pluginsData:[]\n                        }\n                    },\n                    height: \"100%\",\n                    width: \"100%\",\n                });\n            }).catch(res=>{\n                message.warn(res.obj);\n            })\n        }else{\n            hasDocsAPI = false;\n            setTimeout(()=>{\n                this._openEditor()\n            },0)\n        }  \n    }\n    render(){\n        return (\n            <div id='PreviewDoc'>\n                加载中。。。。。。\n            </div>\n        )\n    }\n}\n\nPreviewDoc.defaultProps = {\n    type:'formTaskId'\n}\n\nPreviewDoc.PropType = {\n    id:PropTypes.string.isRequired,//表单任务id\n    type:PropTypes.string.isRequired,//预览类型，'formTaskId'：表单任务，'formId'：表单,'summary':汇总\n    historyId:PropTypes.string,//汇总需要用\n}\n\nexport default PreviewDoc;","/**\n|--------------------------------------------------\n| 解析url传参的search字符串\n|--------------------------------------------------\n*/\nexport const parseUrlSearch=()=>{\n    let href = window.location.href;\n    let paramsIndex = '';\n    let searchObj = {};\n    if (href.indexOf('?') > -1) {            \n        paramsIndex = href.indexOf(\"?\") + 1;\n        let params = href.substr(paramsIndex).split('&');\n        if (params && params.length > 0) {\n            params.forEach(\n                (item) => {\n                    let arr = item.split('=');\n                    searchObj[arr[0]] = arr[1]\n                }\n            )    \n        }\n    }\n    return searchObj\n}"],"sourceRoot":""}
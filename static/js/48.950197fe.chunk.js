(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{1003:function(e,t,a){e.exports={container:"src-pages-formManagement-index-module__container--3tW0P",splitLine:"src-pages-formManagement-index-module__splitLine--3YJ5k",folderContainer:"src-pages-formManagement-index-module__folderContainer--QTnq-",buttonContainer:"src-pages-formManagement-index-module__buttonContainer--1Izqz",folderTree:"src-pages-formManagement-index-module__folderTree--1d1J_",formContainer:"src-pages-formManagement-index-module__formContainer--2E41i",filterBox:"src-pages-formManagement-index-module__filterBox--3Ll83",filterItem:"src-pages-formManagement-index-module__filterItem--2HREF",table:"src-pages-formManagement-index-module__table--1WDgV",workFlowContainer:"src-pages-formManagement-index-module__workFlowContainer--2DUB1",left:"src-pages-formManagement-index-module__left--17pGX",right:"src-pages-formManagement-index-module__right--1HjLB",workPlace:"src-pages-formManagement-index-module__workPlace--2jRRC",buttons:"src-pages-formManagement-index-module__buttons--2GZ0j",item:"src-pages-formManagement-index-module__item--qYz39",body:"src-pages-formManagement-index-module__body--1HHqD"}},1233:function(e,t,a){"use strict";a.r(t);a(296);var o=a(206),n=(a(124),a(42)),r=(a(710),a(711)),i=(a(219),a(7)),s=(a(623),a(111)),c=(a(154),a(25)),m=a(30),l=a(31),d=a(33),p=a(32),u=a(34),f=(a(863),a(861)),g=a(0),b=a.n(g),h=a(1003),y=a.n(h),v=a(949),j=a(80),w=a(814),I=a(63),_=f.a.Dragger,E=function(e){function t(){var e,a;Object(m.a)(this,t);for(var o=arguments.length,n=new Array(o),r=0;r<o;r++)n[r]=arguments[r];return(a=Object(d.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(n)))).state={param:{},data:[],isNeedUpload:!0,fileName:"",formId:null,showPDF:!1},a.getData=function(){var e=a.state.param;Object(I.a)("/ybt/form/info",{formId:e.id}).then(function(e){e.success&&(e.obj.formTemplatePath?a.setState({isNeedUpload:!1,fileName:e.obj.formTemplateName}):a.setState({isNeedUpload:!0,fileName:e.obj.formTemplateName}))})},a.getWidgetList=function(){var e=a.state.param;Object(I.a)("/ybt/form/widget/list",{formId:e.id}).then(function(e){e.success&&a.setState({data:e.obj})})},a.handleFinish=function(){var e=a.state.param;a.state.isNeedUpload?c.a.warning("\u8bf7\u5148\u4e0a\u4f20\u6a21\u677f\u6587\u4ef6"):Object(I.a)("/ybt/form/create/submit",{formId:e.id}).then(function(e){e.success?(c.a.success("\u64cd\u4f5c\u6210\u529f"),a.props.history.push("/formManagement")):c.a.error(e.obj)})},a.goto=function(){a.props.history.replace("/formManagement/setWorkFlow?id=".concat(a.state.param.id))},a._previewDoc=function(){a.setState({showPDF:!0})},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=Object(v.a)();t.id&&this.setState({param:t},function(){e.getData(),e.getWidgetList()})}},{key:"render",value:function(){var e=this,t=this,a=t.state.param?t.state.param.id:"",m=localStorage.getItem("ticket"),l="";m&&(l="?ticket="+m);var d={name:"file",accept:".xml",multiple:!1,action:"/ybt/form/uploadTemplate/".concat(a).concat(l),showUploadList:!1,onChange:function(e){var a=e.file.status;"done"===a?(console.log(e.file.response),e.file.response&&e.file.response.success?(c.a.success("".concat(e.file.name," \u4e0a\u4f20\u6210\u529f")),t.setState({isNeedUpload:!1,fileName:e.file.name,formId:e.file.response.obj.formId})):c.a.error(e.file.response.msg)):"error"===a&&c.a.error("".concat(e.file.name," \u4e0a\u4f20\u5931\u8d25"))}};return b.a.createElement("div",{style:{padding:20}},b.a.createElement(r.a,{title:"\u4e0a\u4f20\u6a21\u677f-".concat(window.sessionStorage.getItem("formManageName")),className:y.a.body,bodyStyle:{padding:0},extra:b.a.createElement("div",null,"\u3010\u8bf7\u4e0a\u4f20XML\u683c\u5f0f\u6a21\u677f\u6587\u4ef6\u3011")},b.a.createElement("div",{className:y.a.item,style:{padding:"20px 0"}},this.state.data.length>0?b.a.createElement("div",null,this.state.data.map(function(e){return b.a.createElement("div",{style:{marginBottom:20}},b.a.createElement("span",{style:{display:"inline-block",width:150,textAlign:"right"}},e.columnComment,"\uff1a"),b.a.createElement("span",null,e.columnName))})):b.a.createElement(s.a,null)),b.a.createElement("div",{className:y.a.item,style:{padding:50}},b.a.createElement(_,d,b.a.createElement("p",{className:"ant-upload-drag-icon"},b.a.createElement(i.a,{type:"inbox"})),b.a.createElement("p",{className:"ant-upload-text"},"\u70b9\u51fb\u6216\u5c06\u6587\u4ef6\u62d6\u62fd\u5230\u8fd9\u91cc\u4e0a\u4f20")),this.state.isNeedUpload?null:b.a.createElement("div",{style:{marginTop:10}},b.a.createElement(i.a,{type:"link",style:{marginRight:10}}),this.state.fileName,b.a.createElement("span",{onClick:this._previewDoc,style:{color:"blue",cursor:"pointer"}},"[\u9884\u89c8]")))),b.a.createElement("div",{className:y.a.buttons,style:{textAlign:"right",marginTop:10}},b.a.createElement(n.a,{type:"primary",ghost:!0,onClick:this.goto},"\u4e0a\u4e00\u6b65"),b.a.createElement(n.a,{type:"primary",style:{margin:"0px 10px"},onClick:this.handleFinish},"\u5b8c\u6210"),b.a.createElement(n.a,{onClick:function(){e.props.history.push("/formManagement")}},"\u53d6\u6d88")),b.a.createElement(o.a,{visible:this.state.showPDF,title:b.a.createElement("span",{style:{fontWeight:"bold"}},"\u9884\u89c8\u6253\u5370"),width:1200,bodyStyle:{padding:0,height:"70vh"},destroyOnClose:!0,footer:!1,onCancel:function(){e.setState({showPDF:!1})}},b.a.createElement(w.a,{id:this.state.param.id,type:"formId"})))}}]),t}(g.Component);t.default=Object(j.g)(E)},814:function(e,t,a){"use strict";a(154);var o=a(25),n=a(613),r=a(30),i=a(31),s=a(33),c=a(32),m=a(34),l=a(0),d=a.n(l),p=a(1),u=a.n(p),f=a(63),g=!1,b=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(s.a)(this,Object(c.a)(t).call(this,e)))._getFormTaskInfo=function(){var e=window.location.host;"formTaskId"===a.props.type?Object(f.a)("/ybt/form/preview/formTask/info?formTaskId=".concat(a.props.id)).then(function(t){if(t.success){var r=Object(n.a)({},t.obj,{url:"http://".concat(e,"/ybt/form/preview/formTask;JSESSIONID=").concat(t.obj.sessionId,"?formTaskId=").concat(a.props.id)});a._setConfig(r)}else o.a.error(t.obj)}):"formId"===a.props.type?Object(f.a)("/ybt/form/preview/form/info?formId=".concat(a.props.id)).then(function(t){if(t.success){var r=Object(n.a)({},t.obj,{url:"http://".concat(e,"/ybt/form/preview/form;JSESSIONID=").concat(t.obj.sessionId,"?formId=").concat(a.props.id)});a._setConfig(r)}else o.a.error(t.obj)}):"summary"===a.props.type?Object(f.a)("/ybt/summary/preview/info?templetId=".concat(a.props.id)).then(function(t){if(t.success){var r=Object(n.a)({},t.obj,{url:"http://".concat(e,"/ybt/summary/data/preview;JSESSIONID=").concat(t.obj.sessionId,"?templetId=").concat(a.props.id,"&historyId=").concat(a.props.historyId)});a._setConfig(r)}else o.a.error(t.obj)}):"summaryPreview"===a.props.type&&Object(f.a)("/ybt/summary/preview/info?templetId=".concat(a.props.id)).then(function(t){if(t.success){var r=Object(n.a)({},t.obj,{url:"http://".concat(e,"/ybt/summary/data/pre/preview/ids;JSESSIONID=").concat(t.obj.sessionId,"?templetId=").concat(a.props.id,"&planTaskIds=").concat(a.props.planTaskIds.join(","))});a._setConfig(r)}else o.a.error(t.obj)})},a._setConfig=function(e){if(document.getElementById("documentScript")){document.getElementById("documentScript").src=e.documentServerApiUrl}else{var t=document.createElement("script");t.id="documentScript",t.type="text/javascript",t.async=!1,t.src=e.documentServerApiUrl,document.head.appendChild(t)}a.setState({config:e},a._openEditor)},a._openEditor=function(){var e=a.state.config,t=window.DocsAPI;(t&&(g=!0),g)?Object(f.a)("/ybt/form/task/getFormTaskStatus?formTaskId="+a.props.id).then(function(e){return e.success?1===e.obj:Promise.reject(e.obj)}).then(function(o){g=!0;var n=localStorage.getItem("ticket");n&&(e.url=e.url+"&ticket="+n),window.docEditor=new t.DocEditor("PreviewDoc",{documentType:e.documentType,document:{fileType:e.fileType,key:e.key,title:e.title,url:e.url,permissions:{download:"formId"===a.props.type||o,print:"formId"===a.props.type||o,edit:!1,fillForms:!1,comment:!1}},editorConfig:{mode:"view",lang:"zh",customization:{chat:!1,comments:!1,help:!1,autosave:!0,commentAuthorOnly:!1,compactToolbar:!1,logo:{image:null,url:null,imageEmbedded:null},about:!1},plugins:{autostart:[],pluginsData:[]}},height:"100%",width:"100%"})}).catch(function(e){o.a.warn(e.obj)}):(g=!1,setTimeout(function(){a._openEditor()},0))},a.state={config:{documentServerApiUrl:"",documentType:"",fileType:"",key:"",title:"",url:""}},a}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this._getFormTaskInfo()}},{key:"render",value:function(){return d.a.createElement("div",{id:"PreviewDoc"},"\u52a0\u8f7d\u4e2d\u3002\u3002\u3002\u3002\u3002\u3002")}}]),t}(d.a.Component);b.defaultProps={type:"formTaskId"},b.PropType={id:u.a.string.isRequired,type:u.a.string.isRequired,historyId:u.a.string},t.a=b},949:function(e,t,a){"use strict";a.d(t,"a",function(){return o});var o=function(){var e=window.location.href,t="",a={};if(e.indexOf("?")>-1){t=e.indexOf("?")+1;var o=e.substr(t).split("&");o&&o.length>0&&o.forEach(function(e){var t=e.split("=");a[t[0]]=t[1]})}return a}}}]);
//# sourceMappingURL=48.950197fe.chunk.js.map